<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Evinha üéÇ">
<meta name="theme-color" content="#140C05">
<title>App da Evinha üéÇ</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
:root{
  --bg:#F5EDE0;--card:#FFFFFF;--text:#1E1208;
  --accent:#C17B3F;--accent2:#8B4513;--rose:#F2D9C0;--border:#EDD9C5;
  --dark:#140C05;--muted:#A08070;
  --green:#27845A;--red:#B83030;--yellow:#C8860A;
}
body{background:var(--bg);color:var(--text);font-family:'Nunito',sans-serif;min-height:100vh;padding-bottom:80px;}

/* HEADER */
.header{background:linear-gradient(160deg,var(--dark) 0%,#2C1005 100%);color:#fff;padding:52px 18px 0;position:sticky;top:0;z-index:100;box-shadow:0 2px 24px rgba(20,12,5,.4);}
.htop{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;}
.htop h1{font-size:21px;font-weight:900;}
.htop h1 span{color:var(--rose);}
.htop-sub{font-size:10px;color:rgba(255,255,255,.4);font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:3px;}
.hright{display:flex;gap:8px;align-items:center;}
.badge{background:var(--accent);color:#fff;font-size:12px;font-weight:800;padding:5px 12px;border-radius:20px;min-width:28px;text-align:center;}
.badge.zero{background:rgba(255,255,255,.12);}
.btn-ref{background:rgba(255,255,255,.1);border:none;color:#fff;width:38px;height:38px;border-radius:12px;font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.3s;}
.btn-ref:active{transform:rotate(180deg);}

/* STATUS FIREBASE */
.fb-status{padding:6px 18px 14px;font-size:11px;font-weight:700;}
.fb-status.ok{color:rgba(100,255,150,.7);}
.fb-status.err{color:rgba(255,100,100,.8);}

/* TABS */
.tabs{display:flex;gap:6px;overflow-x:auto;padding:0 18px 14px;scrollbar-width:none;}
.tabs::-webkit-scrollbar{display:none;}
.tab{flex-shrink:0;padding:7px 14px;border-radius:20px;font-size:12px;font-weight:700;cursor:pointer;border:none;color:rgba(255,255,255,.5);background:transparent;transition:.2s;white-space:nowrap;}
.tab.active{background:rgba(255,255,255,.15);color:#fff;}

/* STATS */
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:1px;background:var(--border);}
.stat{background:var(--card);padding:14px 8px;text-align:center;}
.stat-v{font-size:22px;font-weight:900;line-height:1;}
.stat-v.y{color:var(--yellow);}
.stat-v.g{color:var(--green);}
.stat-v.a{color:var(--accent);}
.stat-l{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-top:3px;}

/* CARDS */
.cards{padding:12px;display:flex;flex-direction:column;gap:12px;}
.empty{text-align:center;padding:80px 24px;}
.empty-icon{font-size:56px;margin-bottom:16px;opacity:.4;}
.empty h3{font-size:17px;font-weight:800;color:var(--muted);margin-bottom:8px;}
.empty p{font-size:13px;color:var(--muted);line-height:1.7;}

.card{background:var(--card);border-radius:18px;overflow:hidden;border:1.5px solid var(--border);box-shadow:0 2px 12px rgba(30,18,8,.05);animation:sIn .3s ease both;}
@keyframes sIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.card.pendente{border-left:4px solid var(--yellow);}
.card.confirmado{border-left:4px solid var(--green);opacity:.82;}
.card.recusado{border-left:4px solid var(--red);opacity:.6;}

.ctop{padding:13px 14px 0;display:flex;align-items:flex-start;justify-content:space-between;gap:8px;}
.cid{font-size:9px;font-weight:800;letter-spacing:2px;text-transform:uppercase;color:var(--muted);}
.spill{font-size:10px;font-weight:800;padding:4px 10px;border-radius:10px;}
.spill.pendente{background:rgba(200,134,10,.15);color:#8A5A00;}
.spill.confirmado{background:rgba(39,132,90,.15);color:#1A5E3A;}
.spill.recusado{background:rgba(184,48,48,.12);color:var(--red);}

.cbody{padding:12px 14px 14px;}
.cnome{font-size:18px;font-weight:900;margin-bottom:2px;}
.ctel{font-size:12px;color:var(--muted);font-weight:600;margin-bottom:10px;}
.ctags{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:12px;}
.ctag{font-size:11px;font-weight:700;padding:4px 10px;border-radius:8px;}
.ctag.p{background:rgba(193,123,63,.1);color:var(--accent2);}
.ctag.d{background:rgba(39,132,90,.1);color:#1A5E3A;}
.ctag.e{background:rgba(30,18,8,.06);color:#5A3A28;}

.details{margin-bottom:12px;}
.drow{display:flex;gap:8px;padding:5px 0;border-bottom:1px solid #F8F0E8;}
.drow:last-child{border-bottom:none;}
.dlabel{font-weight:800;color:var(--muted);white-space:nowrap;min-width:82px;font-size:11px;}
.dval{color:var(--text);font-size:12px;line-height:1.4;}

/* BLOCO PRE√áO */
.preco-bloco{background:linear-gradient(135deg,rgba(193,123,63,.09),rgba(193,123,63,.03));border:1.5px solid rgba(193,123,63,.2);border-radius:14px;padding:14px;margin-bottom:12px;}
.preco-title{font-size:11px;font-weight:800;letter-spacing:1px;text-transform:uppercase;color:var(--accent2);margin-bottom:10px;}
.preco-row{display:flex;align-items:center;gap:8px;}
.preco-sym{font-size:20px;font-weight:900;color:var(--accent);}
.preco-inp{flex:1;padding:12px 14px;border:1.5px solid var(--border);border-radius:12px;font-family:'Nunito',sans-serif;font-size:20px;font-weight:800;color:var(--text);background:#fff;outline:none;transition:.2s;}
.preco-inp:focus{border-color:var(--accent);}
.preco-ok{font-size:22px;font-weight:900;color:var(--green);text-align:center;padding:6px 0;}

/* A√á√ïES */
.actions{display:grid;gap:8px;}
.g2{grid-template-columns:1fr 1fr;}
.btn-a{padding:13px;border-radius:12px;border:none;font-family:'Nunito',sans-serif;font-size:14px;font-weight:800;cursor:pointer;transition:.2s;display:flex;align-items:center;justify-content:center;gap:6px;}
.btn-conf{background:var(--green);color:#fff;}
.btn-rec{background:#F5EDE0;color:var(--red);border:1.5px solid rgba(184,48,48,.2);}
.btn-wpp{background:#25D366;color:#fff;}
.btn-a:active{filter:brightness(.88);}

/* NAV */
.bnav{position:fixed;bottom:0;left:0;right:0;z-index:200;background:var(--card);border-top:1.5px solid var(--border);padding:8px 0 calc(8px + env(safe-area-inset-bottom));display:flex;justify-content:space-around;}
.nbtn{display:flex;flex-direction:column;align-items:center;gap:2px;font-size:9px;font-weight:800;color:var(--muted);cursor:pointer;padding:4px 14px;border-radius:12px;border:none;background:none;text-transform:uppercase;letter-spacing:.5px;}
.nbtn.active{color:var(--accent);}
.nicon{font-size:22px;line-height:1;}

/* TOAST */
.toast{position:fixed;bottom:90px;left:50%;transform:translateX(-50%) translateY(8px);background:var(--dark);color:#fff;padding:11px 22px;border-radius:50px;font-size:13px;font-weight:700;opacity:0;transition:.3s;z-index:400;white-space:nowrap;pointer-events:none;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}

/* HOJE BANNER */
.hoje-banner{margin:10px 12px 0;padding:12px 16px;background:linear-gradient(135deg,rgba(39,132,90,.12),rgba(39,132,90,.05));border:1.5px solid rgba(39,132,90,.2);border-radius:14px;font-size:13px;font-weight:700;color:#1A5E3A;display:none;}

/* PWA */
.pwa{margin:12px 12px 0;padding:12px 16px;background:rgba(193,123,63,.08);border:1.5px dashed rgba(193,123,63,.25);border-radius:14px;font-size:12px;color:var(--accent2);font-weight:700;display:flex;align-items:center;gap:10px;}

/* Config warning */
.cfg-warn{background:#fff3cd;border:1.5px solid #ffc107;border-radius:12px;padding:14px 16px;margin:12px;font-size:13px;color:#856404;line-height:1.7;}
.cfg-warn strong{display:block;margin-bottom:4px;}
</style>
</head>
<body>

<div class="header">
  <div class="htop">
    <div><div class="htop-sub">Painel de</div><h1>üéÇ <span>Evinha</span></h1></div>
    <div class="hright">
      <div class="badge zero" id="badgePend">0</div>
      <button class="btn-ref" id="btnRef">‚Üª</button>
    </div>
  </div>
  <div class="fb-status" id="fbStatus">‚è≥ Conectando...</div>
  <div class="tabs">
    <button class="tab active" data-tab="todos">Todos</button>
    <button class="tab" data-tab="pendente">‚è≥ Novos</button>
    <button class="tab" data-tab="confirmado">‚úÖ Confirmados</button>
    <button class="tab" data-tab="recusado">‚ùå Recusados</button>
  </div>
</div>

<div class="stats">
  <div class="stat"><div class="stat-v y" id="stP">0</div><div class="stat-l">Pendentes</div></div>
  <div class="stat"><div class="stat-v g" id="stC">0</div><div class="stat-l">Confirmados</div></div>
  <div class="stat"><div class="stat-v a" id="stF">R$0</div><div class="stat-l">Faturamento</div></div>
</div>

<div class="cfg-warn" id="cfgWarn">
  <strong>‚öôÔ∏è Configure o Firebase!</strong>
  Abra este arquivo num editor de texto e cole seus dados do Firebase onde indicado.<br>
  Veja o arquivo <b>LEIA-ME.txt</b> para o passo a passo completo.
</div>

<div class="pwa" id="pwaHint">üì≤ <span>No Chrome: <b>‚ãÆ ‚Üí Adicionar √† tela inicial</b> para usar como app!</span></div>
<div class="hoje-banner" id="hojeBanner"></div>
<div class="cards" id="cardsEl"></div>

<nav class="bnav">
  <button class="nbtn active" onclick="render()"><span class="nicon">üè†</span>In√≠cio</button>
  <button class="nbtn" id="navHoje"><span class="nicon">üìÖ</span>Hoje</button>
  <button class="nbtn" id="navTeste"><span class="nicon">üß™</span>Teste</button>
  <button class="nbtn" id="navLimpar"><span class="nicon">üóëÔ∏è</span>Limpar</button>
</nav>

<div class="toast" id="toast"></div>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
import { getDatabase, ref, onValue, update, push, remove, query, orderByChild } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  üîß COLE AQUI OS DADOS DO SEU FIREBASE
//  (os mesmos dados do formulario-pedido.html)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const FIREBASE_CONFIG = {
  apiKey:            "AIzaSyAzTnR7TfXrnZvYRYrrKBdI2yoqqZyC648",
  authDomain:        "bolo-evinha.firebaseapp.com",
  databaseURL:       "https://bolo-evinha-default-rtdb.firebaseio.com",
  projectId:         "bolo-evinha",
  storageBucket:     "bolo-evinha.firebasestorage.app",
  messagingSenderId: "711837183882",
  appId:             "1:711837183882:web:6ebaf9c5d726413b292273"
};
const MEU_NUMERO = '5527998973988'; // WhatsApp da Evinha
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const configurado = FIREBASE_CONFIG.apiKey !== "COLE_AQUI";
let db, pedidosMap = {}, filtro = 'todos';

if (configurado) {
  document.getElementById('cfgWarn').style.display = 'none';
  const app = initializeApp(FIREBASE_CONFIG);
  db = getDatabase(app);
  // Escuta em tempo real ‚Äî qualquer novo pedido aparece na hora!
  const pedidosRef = ref(db, 'pedidos');
  onValue(pedidosRef, snap => {
    pedidosMap = snap.val() || {};
    render();
    document.getElementById('fbStatus').textContent = 'üü¢ Conectado ao Firebase';
    document.getElementById('fbStatus').style.color = 'rgba(100,255,150,.7)';
  }, err => {
    document.getElementById('fbStatus').textContent = 'üî¥ Erro: ' + err.message;
    document.getElementById('fbStatus').style.color = 'rgba(255,100,100,.8)';
  });
} else {
  document.getElementById('fbStatus').textContent = 'üî¥ Firebase n√£o configurado';
  document.getElementById('fbStatus').style.color = 'rgba(255,100,100,.8)';
}

// ‚îÄ‚îÄ Render ‚îÄ‚îÄ
window.render = function() {
  const todos = Object.entries(pedidosMap)
    .map(([key, p]) => ({...p, _key: key}))
    .sort((a,b) => (b.timestamp||'').localeCompare(a.timestamp||''));

  const lista = filtro === 'todos' ? todos : todos.filter(p=>p.status===filtro);

  // Stats
  const pend = todos.filter(p=>p.status==='pendente').length;
  const conf = todos.filter(p=>p.status==='confirmado').length;
  const fat = todos.filter(p=>p.status==='confirmado'&&p.preco).reduce((s,p)=>s+(+p.preco||0),0);
  document.getElementById('stP').textContent = pend;
  document.getElementById('stC').textContent = conf;
  document.getElementById('stF').textContent = 'R$'+fat.toFixed(0);
  const badge = document.getElementById('badgePend');
  badge.textContent = pend; badge.className='badge'+(pend===0?' zero':'');

  // Hoje
  const hoje = new Date().toISOString().split('T')[0];
  const hj = todos.filter(p=>p.dataEntrega===hoje&&p.status==='confirmado');
  const hojeBanner = document.getElementById('hojeBanner');
  if(hj.length){hojeBanner.style.display='block';hojeBanner.innerHTML=`üìÖ <strong>${hj.length} entrega(s) hoje!</strong> ${hj.map(p=>p.cliente).join(', ')}`;}
  else hojeBanner.style.display='none';

  if(!lista.length){
    const msgs={todos:'Nenhum pedido ainda.\nQuando um cliente pedir, aparece aqui! üéÇ',pendente:'Sem novos pedidos üéâ',confirmado:'Nenhum confirmado ainda.',recusado:'Nenhum recusado.'};
    document.getElementById('cardsEl').innerHTML=`<div class="empty"><div class="empty-icon">üéÇ</div><h3>Tudo vazio</h3><p>${msgs[filtro]||''}</p></div>`;
    return;
  }

  document.getElementById('cardsEl').innerHTML = lista.map((p,i) => {
    const df = p.dataFormatada || (p.dataEntrega?new Date(p.dataEntrega+'T12:00').toLocaleDateString('pt-BR',{day:'2-digit',month:'short'}):'‚Äî');
    const sl = {pendente:'‚è≥ Novo pedido',confirmado:'‚úÖ Confirmado',recusado:'‚ùå Recusado'}[p.status]||p.status;
    const detalheRows = [
      ['Pessoas', (p.pessoas||'?')+' pessoas'+(p.formaIdeal?' ('+p.formaIdeal+')':'')],
      p.ocasiao?['Ocasi√£o',p.ocasiao]:null,
      ['Recheio', p.recheios&&p.recheios.length?p.recheios.join(', '):'A combinar'],
      p.recheioObs?['Obs. recheio',p.recheioObs]:null,
      ['Cobertura', p.cobertura||'A combinar'],
      p.decoracao?['Decora√ß√£o',p.decoracao]:null,
      ['Entrega', (p.entrega||'‚Äî')+(p.endereco?' ‚Äî '+p.endereco:'')],
      p.obsGeral?['Obs.',p.obsGeral]:null,
    ].filter(Boolean);

    const precoBloco = p.status==='pendente'
      ? `<div class="preco-bloco"><div class="preco-title">üí∞ Defina o valor do bolo</div><div class="preco-row"><span class="preco-sym">R$</span><input class="preco-inp" type="number" id="preco-${p._key}" placeholder="0,00" min="0" step="0.01" inputmode="decimal"></div></div>`
      : p.preco ? `<div class="preco-bloco"><div class="preco-title">üí∞ Valor cobrado</div><div class="preco-ok">R$ ${(+p.preco).toFixed(2).replace('.',',')}</div></div>` : '';

    const acoes = p.status==='pendente'
      ? `<div class="actions g2"><button class="btn-a btn-conf" onclick="confirmar('${p._key}')">‚úÖ Confirmar</button><button class="btn-a btn-rec" onclick="recusar('${p._key}')">‚ùå Recusar</button></div><div class="actions" style="margin-top:8px"><button class="btn-a btn-wpp" onclick="chamarWpp('${p._key}')">üí¨ Chamar no WhatsApp</button></div>`
      : p.status!=='recusado' ? `<div class="actions"><button class="btn-a btn-wpp" onclick="chamarWpp('${p._key}')">üí¨ WhatsApp do cliente</button></div>` : '';

    return `<div class="card ${p.status}" style="animation-delay:${i*.04}s">
      <div class="ctop"><div class="cid">${p.id||p._key}</div><span class="spill ${p.status}">${sl}</span></div>
      <div class="cbody">
        <div class="cnome">${p.cliente||'‚Äî'}</div>
        <div class="ctel">üì± ${p.telefone||'‚Äî'}</div>
        <div class="ctags">
          <span class="ctag p">üë• ${p.pessoas||'?'} pessoas</span>
          <span class="ctag d">üìÖ ${df}</span>
          <span class="ctag e">${p.entrega==='Entrega'?'üöó Entrega':'üè† Retirada'}</span>
        </div>
        <div class="details">${detalheRows.map(([l,v])=>`<div class="drow"><span class="dlabel">${l}</span><span class="dval">${v}</span></div>`).join('')}</div>
        ${precoBloco}${acoes}
      </div>
    </div>`;
  }).join('');
};

// ‚îÄ‚îÄ Confirmar ‚îÄ‚îÄ
window.confirmar = async key => {
  const p = {...pedidosMap[key], _key: key};
  const precoInp = document.getElementById('preco-'+key);
  const precoVal = precoInp ? parseFloat(precoInp.value)||null : null;
  await update(ref(db,'pedidos/'+key), {status:'confirmado', preco:precoVal, confirmedAt:new Date().toISOString()});
  toast('‚úÖ Pedido confirmado!');
  const df = p.dataFormatada || (p.dataEntrega?new Date(p.dataEntrega+'T12:00').toLocaleDateString('pt-BR'):'‚Äî');
  const precoStr = precoVal ? `R$ ${precoVal.toFixed(2).replace('.',',')}` : 'a combinar';
  const msg = `Oi ${p.cliente}! üéÇ\n\nSeu pedido foi *CONFIRMADO*! üéâ\n\nüéÇ ${p.recheios&&p.recheios.length?p.recheios.join(', '):'Combinado'}\nüìÖ Data: ${df}\nüí∞ Valor: *${precoStr}*\n\nQualquer d√∫vida me chama aqui! üíõ`;
  const tel = (p.telefone||'').replace(/\D/g,'');
  if(tel) window.open(`https://wa.me/55${tel}?text=${encodeURIComponent(msg)}`,'_blank');
};

// ‚îÄ‚îÄ Recusar ‚îÄ‚îÄ
window.recusar = async key => {
  if(!confirm('Recusar este pedido?')) return;
  const p = pedidosMap[key];
  await update(ref(db,'pedidos/'+key), {status:'recusado'});
  toast('‚ùå Pedido recusado');
  const msg = `Oi ${p.cliente}! üòî\n\nInfelizmente n√£o vou conseguir atender seu pedido para essa data.\n\nMe chama aqui para tentarmos outra data! Vai ser um prazer fazer seu bolo üéÇüíõ`;
  const tel = (p.telefone||'').replace(/\D/g,'');
  if(tel) window.open(`https://wa.me/55${tel}?text=${encodeURIComponent(msg)}`,'_blank');
};

// ‚îÄ‚îÄ WhatsApp ‚îÄ‚îÄ
window.chamarWpp = key => {
  const p = pedidosMap[key];
  const tel = (p.telefone||'').replace(/\D/g,'');
  if(!tel) return;
  window.open(`https://wa.me/55${tel}?text=${encodeURIComponent(`Oi ${p.cliente}! üéÇ Aqui √© a Evinha, estou vendo seu pedido...`)}`,'_blank');
};

// ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ
document.querySelectorAll('.tab').forEach(t => {
  t.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active'); filtro=t.dataset.tab; render();
  });
});

// ‚îÄ‚îÄ Refresh ‚îÄ‚îÄ
document.getElementById('btnRef').addEventListener('click', ()=>toast('üîÑ Atualizando...'));

// ‚îÄ‚îÄ Hoje ‚îÄ‚îÄ
document.getElementById('navHoje').addEventListener('click', () => {
  filtro='confirmado';
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelector('[data-tab="confirmado"]').classList.add('active');
  render(); toast('üìÖ Mostrando confirmados');
});

// ‚îÄ‚îÄ Limpar recusados ‚îÄ‚îÄ
document.getElementById('navLimpar').addEventListener('click', async () => {
  if(!configurado){toast('Configure o Firebase primeiro!');return;}
  if(!confirm('Remover todos os pedidos recusados?')) return;
  const prom = Object.entries(pedidosMap)
    .filter(([,p])=>p.status==='recusado')
    .map(([key])=>remove(ref(db,'pedidos/'+key)));
  await Promise.all(prom);
  toast('üóëÔ∏è Recusados removidos');
});

// ‚îÄ‚îÄ Pedido de TESTE ‚îÄ‚îÄ
document.getElementById('navTeste').addEventListener('click', async () => {
  if(!configurado){toast('Configure o Firebase primeiro!');return;}
  const fake = {
    id:'EV-TESTE'+Math.random().toString(36).substr(2,4).toUpperCase(),
    timestamp:new Date().toISOString(),
    cliente:'Maria Teste',telefone:'(11) 98888-1234',
    pessoas:20,formaIdeal:'Forma m√©dia (20cm)',
    ocasiao:'Anivers√°rio de 10 anos',
    recheios:['Brigadeiro','Morango','Leite Ninho'],
    recheioObs:'Pouco a√ß√∫car, por favor',
    cobertura:'Chantilly',
    decoracao:'Tema princesas, rosa e dourado, escrever Feliz Anivers√°rio J√∫lia',
    dataEntrega:new Date(Date.now()+3*86400000).toISOString().split('T')[0],
    dataFormatada:new Date(Date.now()+3*86400000).toLocaleDateString('pt-BR'),
    entrega:'Retirada no local',endereco:'',
    obsGeral:'Sou al√©rgica a nozes!',
    status:'pendente',preco:null
  };
  await push(ref(db,'pedidos'), fake);
  toast('üß™ Pedido de teste criado!');
});

// ‚îÄ‚îÄ Toast ‚îÄ‚îÄ
function toast(msg) {
  const t=document.getElementById('toast');
  t.textContent=msg; t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),2800);
}
window.toast = toast;

// ‚îÄ‚îÄ PWA hint ‚îÄ‚îÄ
if(window.innerWidth>600||window.matchMedia('(display-mode:standalone)').matches)
  document.getElementById('pwaHint').style.display='none';

// Render inicial
render();
</script>
</body>
</html>
